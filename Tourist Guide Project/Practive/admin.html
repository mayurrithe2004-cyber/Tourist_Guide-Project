<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Admin — Tourist Guide (Pro)</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
  :root{--bg:#f2f7ff;--card:#fff;--accent:#0f4c81;--muted:#6b7280}
  *{box-sizing:border-box;font-family:Inter,Segoe UI,Roboto,Arial}
  body{margin:0;background:var(--bg);color:#04222b}
  header{padding:12px 20px;background:linear-gradient(90deg,#00203f,#0f4c81);color:#fff;display:flex;justify-content:space-between;align-items:center}
  .wrap{display:grid;grid-template-columns:260px 1fr;gap:20px;padding:20px}
  .sidebar{background:linear-gradient(180deg,#00203f,#0f4c81);color:#fff;padding:16px;border-radius:12px;height:calc(100vh - 80px)}
  .menu a{display:block;padding:10px;border-radius:8px;color:#eaf4ff;text-decoration:none;margin-bottom:8px}
  .menu a.active{background:rgba(255,255,255,.06)}
  .main{padding:18px}
  .top{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
  .stats{display:flex;gap:12px;margin-bottom:16px}
  .stat{background:var(--card);padding:12px;border-radius:10px;flex:1;box-shadow:0 10px 30px rgba(10,30,60,.06)}
  table{width:100%;border-collapse:collapse}
  th,td{padding:10px;border-bottom:1px solid #eef6ff;text-align:left;font-size:14px}
  .btn{padding:8px 10px;border-radius:8px;border:none;background:var(--accent);color:#fff;cursor:pointer}
  .muted{color:var(--muted)}
  footer{padding:18px;text-align:center;color:var(--muted)}
  @media(max-width:900px){.wrap{grid-template-columns:1fr}.sidebar{height:auto}}
</style>
</head>
<body>

<header>
  <div style="font-weight:700"><i class="fa fa-globe"></i> Tourist Guide — Admin</div>
  <div><button class="btn" onclick="logout()">Back to site</button></div>
</header>

<div class="wrap">
  <aside class="sidebar">
    <div style="font-size:20px;font-weight:700;margin-bottom:8px">Admin</div>
    <div class="muted" style="margin-bottom:10px">manage the platform</div>
    <nav class="menu">
      <a id="mDash" class="active" onclick="render('dashboard')">Dashboard</a>
      <a id="mUsers" onclick="render('users')">Users</a>
      <a id="mBookings" onclick="render('bookings')">Bookings</a>
      <a id="mDests" onclick="render('destinations')">Destinations</a>
      <a onclick="seedDemo()" style="margin-top:8px;background:#eaf6ff;color:var(--accent);padding:8px;border-radius:8px;display:block;text-align:center">Seed Demo</a>
    </nav>
  </aside>

  <main class="main" id="main">
    <!-- content from JS -->
  </main>
</div>

<footer>© 2025 Tourist Guide — Admin</footer>

<script>
/* Admin guards + state */
const LS = 'tg_pro_v4';
let state = JSON.parse(localStorage.getItem(LS)) || null;
if(!state){ alert('No demo data: please open index.html first to seed sample data.'); location.href='index.html'; }
(function auth(){
  // simple admin login prompt
  const email = prompt('Admin (demo) email','admin@admin.com');
  const pass = prompt('Password','admin123');
  if(email !== state.admin.email || pass !== state.admin.pass){ alert('Invalid admin — returning to site'); location.href='index.html'; }
  render('dashboard');
})();

function save(){localStorage.setItem(LS, JSON.stringify(state))}

function clearActive(){document.querySelectorAll('.menu a').forEach(a=>a.classList.remove('active'))}
function render(page){
  clearActive(); document.getElementById('mDash').classList.toggle('active', page==='dashboard');
  document.getElementById('mUsers').classList.toggle('active', page==='users');
  document.getElementById('mBookings').classList.toggle('active', page==='bookings');
  document.getElementById('mDests').classList.toggle('active', page==='destinations');
  const main = document.getElementById('main'); main.innerHTML = '';
  if(page==='dashboard'){
    const revenue = (state.bookings||[]).reduce((s,b)=>s+b.amount,0);
    main.innerHTML = `<div class="top"><h2>Dashboard</h2><div class="muted">Admin: ${state.admin.name}</div></div>
      <div class="stats">
        <div class="stat"><h3>Users</h3><p style="font-size:20px">${state.users.length}</p></div>
        <div class="stat"><h3>Bookings</h3><p style="font-size:20px">${state.bookings.length}</p></div>
        <div class="stat"><h3>Revenue</h3><p style="font-size:20px">₹${revenue.toLocaleString()}</p></div>
      </div>
      <div class="card"><h3>Recent Bookings</h3><div id="rb"></div></div>`;
    const recent = (state.bookings||[]).slice(-6).reverse();
    let t = '<table><thead><tr><th>Tourist</th><th>Package</th><th>Travel</th><th>Amount</th></tr></thead><tbody>';
    recent.forEach(b=>{
      const u = state.users.find(x=>x.id===b.touristId) || {name:'-'};
      t += `<tr><td>${u.name}</td><td>${b.packageName}</td><td>${b.travelDate}</td><td>₹${b.amount}</td></tr>`;
    });
    t += '</tbody></table>';
    document.getElementById('rb').innerHTML = t;
  }
  if(page==='users'){
    let html = '<h2>Users</h2><div class="card"><table><thead><tr><th>Name</th><th>Email</th><th>Bookings</th><th>Actions</th></tr></thead><tbody>';
    state.users.forEach(u=> html += `<tr><td>${u.name}</td><td>${u.email}</td><td>${u.bookings.length}</td><td><button class="btn" onclick="viewUser(${u.id})">View</button></td></tr>`);
    html += '</tbody></table></div>'; main.innerHTML = html;
  }
  if(page==='bookings'){
    let html = '<h2>Bookings</h2><div class="card"><table><thead><tr><th>Tourist</th><th>Package</th><th>Travel</th><th>Amount</th><th>Action</th></tr></thead><tbody>';
    state.bookings.forEach(b=>{
      const u = state.users.find(x=>x.id===b.touristId) || {name:'-'};
      html += `<tr><td>${u.name}</td><td>${b.packageName}</td><td>${b.travelDate}</td><td>₹${b.amount}</td><td><button class="btn" onclick="deleteBooking(${b.id})">Delete</button></td></tr>`;
    });
    html += '</tbody></table></div>'; main.innerHTML = html;
  }
  if(page==='destinations'){
    let html = '<h2>Destinations</h2><div class="card"><table><thead><tr><th>Place</th><th>Location</th><th>Price</th><th>Action</th></tr></thead><tbody>';
    state.destinations.forEach(d=> html += `<tr><td>${d.name}</td><td>${d.location}</td><td>₹${d.price}</td><td><button class="btn" onclick="deleteDest(${d.id})">Delete</button></td></tr>`);
    html += '</tbody></table><div style="margin-top:12px"><button class="btn" onclick="addDest()">Add Destination</button></div></div>'; main.innerHTML = html;
  }
}

function viewUser(id){ const u = state.users.find(x=>x.id===id); alert(JSON.stringify(u,null,2)); }
function deleteBooking(id){ if(!confirm('Delete booking?')) return; state.bookings = state.bookings.filter(b=>b.id!==id); state.users.forEach(u=>u.bookings=u.bookings.filter(x=>x!==id)); save(); render('bookings'); }
function deleteDest(id){ if(!confirm('Delete destination (bookings removed)?')) return; state.destinations = state.destinations.filter(x=>x.id!==id); state.bookings = state.bookings.filter(b=>b.destinationId!==id); state.users.forEach(u=>u.bookings=u.bookings.filter(bid=>state.bookings.find(bb=>bb.id===bid))); save(); render('destinations'); }
function addDest(){ const name = prompt('Name'); if(!name) return; const loc = prompt('Location'); const price = +prompt('Price')||0; const id = Math.max(0,...state.destinations.map(x=>x.id))+1; state.destinations.push({id,name,location:loc,price,img:''}); save(); render('destinations'); }
function seedDemo(){ if(!confirm('Seed sample demo data? This resets local demo state.')) return; localStorage.removeItem(LS); alert('Reloading'); location.href='index.html'; }
function logout(){ location.href='index.html'; }
</script>
</body>
</html>
